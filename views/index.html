{{ block "Home" . }}
<!DOCTYPE html>
<html>
    <head>
	<meta charset="UTF-8">
	<meta name="viewprt" content="width=device-width, initial-scale-1">
	<script src="https://unpkg.com/htmx.org@1.9.11" integrity="sha384-0gxUXCCR8yv9FM2b+U3FDbsKthCI66oH5IA9fHppQq9DDMHuMauqq1ZHBpJxQ0J0" crossorigin="anonymous"></script>
	<link href="/styles" rel="stylesheet">
	<title>joist</title>
    </head>
    <body>
	<header class="segment">
	    <h1>
	    {{ template "form" .Data }}
	    </h1>
	</header> 
	<div class="geometry">
	    <form hx-post="/geometry"  hx-target="#tabla1">
		<label>
		    Truss Type:
		    <select name="trussType">
			<option value="warren">warren</option>
			<option value="warrenModified">warren modified</option>
		    </select>
		</label>
		<label>
		    Joist Type
		    <select name="joistType">
			<option value="roof">roof</option>
			<option value="mezzanine">mezzanine</option>
		    </select>
		</label>
		<label>
		    Deflexion
		    <select name="deflexion">
			<option value="240">240</option>
<option value="360">360</option>
		    </select>
		</label>
		<label>Span:
		    <input name="span" type="number" step=".001">
		</label>
		<label>
		    First End Panel Length:
		    <input name="fepl" type="number" step=".001">
		</label>
		<label>
		    Second End Panel Length:
		    <input name="sepl" type="number" step=".001">
		</label>
		<label>
		    Interior Panel Length:
		    <input name="ipl" type="number" step=".001">
		</label>
		<label>
		    From End Panel to Bottom Chord:
		    <input name="lbe" type="number" step=".001">
		</label>
		<label>
		    Joist depth:
		    <input name="depth" type="number" step=".001">
		</label>
		<button type="submit"> submit </button>
	    </form>

	    <div id="tabla1">
	    {{ template "geometryResponse" .ResGeom }}
	    </div>
	    {{ template "webMember" }}
	</div>	
	<h2>Material and Section</h2>
	<div class="material">
	    <form hx-post="/material"  hx-target="#tabla2">
		<label>
		    Yield Stress (Fy):
		    <input name="yieldStress" type="number" step=".001" >
		</label>
		<label>
		    Modulus of Elasticity (E):
		    <input name="modElas" type="number" step=".001">
		</label>
		<label>
		    Spacing between chord angles:
		    <input type="number" name="spaceChord" step=".001">
		</label>
		<label>
		    weight:
		    <input placeholder="lb/ft" type="number" name="weight" step=".001">
		</label>
		<label>
		    B. Seat D:
		    <input type="number" name="bSeat" step=".001">
		</label>
		<label>
		    Top Chord Mark
		    <input type="number" name="topChord">
		</label>
		<label>
		    Bottom Chord Mark
		    <input type="number" name="bottomChord">
		</label>

		<h3>Please fill Mid-panel info</h3>
		<label>
		    Top Chord (max)
		    <select name="topChord">
			<option value="yes">yes</option>
			<option value="no">no</option>
		    </select>
		</label>
		<label>
		    Bottom Chord (max)
		    <select name="bottomChord">
			<option value="yes">yes</option>
			<option value="no">no</option>
		    </select>
		</label>
		<label>
		    Top Chord End Panel 1
		    <select name="topChordEP1">
			<option value="yes">yes</option>
			<option value="no">no</option>
		    </select>
		</label>
		<label>
		    Top Chord End Panel 2
		    <select name="topChordEP2">
			<option value="yes">yes</option>
			<option value="no">no</option>
		    </select>
		</label>
		<button type="submit"> submit </button>
	    </form>
	    <div id="tabla2">
	    {{ template "materialResponse" . }}
	    </div>
	</div>

	<h2>Design Loads</h2>
	<form>
	    <label>
		Ultimate design load Wu:
		<input name="udlw" type="number">
	    </label>
	    <label>
		Live Load WLL (service load):
		<input name="llWLL" type="number">
	    </label>
	    <label>
		Net suction LRFD:
		<input name="nsLRFD" type="number">
	    </label>
	    <label>
		Net suction ASD:
		<input name="nsASD" type="number">
	    </label>
	</form>

	<script>
	    document.addEventListener("DOMContentLoaded", (event) => {
		document.body.addEventListener("htmx:beforeSwap", function(evt) {
		    if(evt.detail.xhr.status === 422) {
			// allow 422 responses to swap as we are using this as a signal that
			// a form was submitted with bad data and want to rerender with the
			// errors
			//
			// set isError to false to avoid error logging in console
			evt.detail.shouldSwap = true;
			evt.detail.isError = false;
		    }
		})
	    })
	</script>
    </body>
    <html>
{{ end }}

{{ block "form" . }}
    {{ range .Contacts }}
    	{{ template "contact" . }}
    {{ end }}
{{ end }}

{{ block "contact" . }}
	{{ .Name }}
	{{ .Email }}
{{ end }}

{{ block "geometryResponse" . }}
    {{ $ResProp := index .ResProps 0 }}
		<table>
		    <tbody>
			<tr>
			    <td>bottom chord to bottom panel</td>
			    <td>{{ $ResProp.Lbe2 }}</td>
			</tr>
			<tr>
			    <td>Design length</td>
			    <td>{{ $ResProp.DLength }}</td>
			</tr>
			<tr>
			    <td>Total interior Panels</td>
			    <td>{{ $ResProp.Tip }}</td>
			</tr>
			<tr>
			    <td>Total Diagonals</td>
			    <td>{{ $ResProp.Tod }}</td>
			</tr>
			<tr>
			    <td>Total struts</td>
			    <td>{{ $ResProp.Ts }}</td>
			</tr>
			<tr>
			    <td>Effective Depth</td>
			    <td>{{ $ResProp.Ed }}</td>
			</tr>
		    </tbody>
		</table>
		<hr>
		<p>The span of a joist shall not exceed 24 time the depth</p>
		<p>Span/Depth Ratio = {{ $ResProp.Dmin }} less than depth joist =  </p>
{{ end }}


{{ block "materialResponse" . }}
    {{ $AnglProp := index .ResMater.AnglProps 0 }}
		<table>
		    <tbody>
			<tr>
			    <td>Area Top Chord</td>
			    <td>{{ $AnglProp.AreaTop }}</td>
			</tr>
			<tr>
			    <td>rx Top Chord</td>
			    <td>{{ $AnglProp.RxTop }}</td>
			</tr>
			<tr>
			    <td>rz Top Chord</td>
			    <td>{{ $AnglProp.RxTop }}</td>
			</tr>
			<tr>
			    <td>ry Top Chord</td>
			    <td>{{ $AnglProp.RyTop }}</td>
			</tr>
			<tr>
			    <td>Y Top Chord</td>
			    <td>{{ $AnglProp.YTop }}</td>
			</tr>
			<tr>
			    <td>Ix Top Chord</td>
			    <td>{{ $AnglProp.IxTop }}</td>
			</tr>
			<tr>
			    <td>Iy Top Chord</td>
			    <td>{{ $AnglProp.IyTop }}</td>
			</tr>
			<tr>
			    <td>b Top Chord</td>
			    <td>{{ $AnglProp.BTop }}</td>
			</tr>
			<tr>
			    <td>t Top Chord</td>
			    <td>{{ $AnglProp.TTop }}</td>
			</tr>
			<tr>
			    <td>Q Top Chord</td>
			    <td>{{ $AnglProp.QTop }}</td>
			</tr>
		    </tbody>
		</table>
		<hr>
		
		<table>
		    <tbody>
			<tr>
			    <td>Area Bottom Chord</td>
			    <td>{{ $AnglProp.AreaBot }}</td>
			</tr>
			<tr>
			    <td>rx Bottom Chord</td>
			    <td>{{ $AnglProp.RxBot }}</td>
			</tr>
			<tr>
			    <td>rz Bottom Chord</td>
			    <td>{{ $AnglProp.RzBot }}</td>
			</tr>
			<tr>
			    <td>ry Bottom Chord</td>
			    <td>{{ $AnglProp.RyBot }}</td>
			</tr>
			<tr>
			    <td>Y Bottom Chord</td>
			    <td>{{ $AnglProp.YBot }}</td>
			</tr>
			<tr>
			    <td>Ix Bottom Chord</td>
			    <td>{{ $AnglProp.IxBot }}</td>
			</tr>
			<tr>
			    <td>Iy Bottom Chord</td>
			    <td>{{ $AnglProp.IyBot }}</td>
			</tr>
			<tr>
			    <td>b Bottom Chord</td>
			    <td>{{ $AnglProp.BBot }}</td>
			</tr>
			<tr>
			    <td>t Bottom Chord</td>
			    <td>{{ $AnglProp.TBot }}</td>
			</tr>
			<tr>
			    <td>Q Bottom Chord</td>
			    <td>{{ $AnglProp.QBot }}</td>
			</tr>
		    </tbody>
		</table>
		<hr>
	    <div class="brid">
		<p>maximum spacing of bridging</p>
		<p>Line bridging 1</p>

		<p>Line bridging 2</p>
	    </div>
{{ end }}
